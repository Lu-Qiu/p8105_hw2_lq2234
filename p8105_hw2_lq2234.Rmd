---
title: "Homework 2"
author: "Lu Qiu"
date: "2023-09-27"
output: github_document
---

```{r, echo=TRUE, message=FALSE}
library(tidyverse)
```

### Problem 1
First, clean the data in pols-month.csv.

```{r}
pols_month = 
  read_csv("./data/pols-month.csv") |>
  janitor::clean_names() |>
  separate(mon, into = c('year', 'month', 'day'), sep = '-') |>
  mutate(
    year = as.numeric(year)
  ) |>
  mutate(
    month = case_match(
      month,
      '01' ~ 'January',
      '02' ~ 'February',
      '03' ~ 'March',
      '04' ~ 'April',
      '05' ~ 'May',
      '06' ~ 'June',
      '07' ~ 'July',
      '08' ~ 'August',
      '09' ~ 'September',
      '10' ~ 'October',
      '11' ~ 'November',
      '12' ~ 'December'
    )) |>
  mutate(
    president = case_match(
      prez_dem,
      1  ~ 'dem',
      0 ~ 'gop'
    )) |>
  select(-c(prez_dem, prez_gop, day))
```

Second, clean the data in snp.csv using a similar process to the above. For consistency across datasets, arrange according to year and month, and organize so that year and month are the leading columns.

```{r}
snp_df = 
  read_csv("./data/snp.csv") |>
  janitor::clean_names() |>
  mutate(
    date = as.Date(date, format = '%m/%d/%y')
  ) |>
  mutate(
    date = as.Date(ifelse(date > Sys.Date(),
                           format(date, '19%y-%m-%d'),
                           format(date)))
  ) |>
  separate(date, into = c('year', 'month', 'day'), sep = '-') |>
  mutate(
    year = as.numeric(year)
  ) |>
  mutate(
    month = case_match(
      month,
      '01' ~ 'January',
      '02' ~ 'February',
      '03' ~ 'March',
      '04' ~ 'April',
      '05' ~ 'May',
      '06' ~ 'June',
      '07' ~ 'July',
      '08' ~ 'August',
      '09' ~ 'September',
      '10' ~ 'October',
      '11' ~ 'November',
      '12' ~ 'December'
    )) |>
  select(-day) |>
  arrange(year, month) |>
  relocate(year, month)
```

Third, tidy the unemployment data so that it can be merged with the previous datasets. This process will involve switching from “wide” to “long” format; ensuring that key variables have the same name; and ensuring that key variables take the same values.

```{r}
unemployment_df = 
  read_csv("./data/unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(
    jan:dec,
    names_to = 'month',
    values_to = 'unemployment_percentage'
  ) |>
  mutate(
    month = case_match(
      month,
      'jan' ~ 'January',
      'feb' ~ 'February',
      'mar' ~ 'March',
      'apr' ~ 'April',
      'may' ~ 'May',
      'jun' ~ 'June',
      'jul' ~ 'July',
      'aug' ~ 'August',
      'sep' ~ 'September',
      'oct' ~ 'October',
      'nov' ~ 'November',
      'dec' ~ 'December'
    )) 
  
```
Join the datasets by merging snp into pols, and merging unemployment into the result.
```{r}
middle_df = 
  left_join(pols_month, snp_df, by = c('year','month'))
final_df = 
  left_join(middle_df, unemployment_df, by = c('year','month'))
```
Write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).  

* The `pols_month` dataset has `r nrow(pols_month)` rows and `r ncol(pols_month)` columns. The range of years is (`r range(pols_month$year)`). The names of key variables are: `r names(pols_month)`.
* The `snp_df` dataset has `r nrow(snp_df)` rows and `r ncol(snp_df)` columns. The range of years is (`r range(snp_df$year)`). The names of key variables are: `r names(snp_df)`.
* The `unemployment_df` dataset has `r nrow(unemployment_df)` rows and `r ncol(unemployment_df)` columns. The range of years is (`r range(unemployment_df$year)`). The names of key variables are: `r names(unemployment_df)`.
* The resulting dataset `final_df` has `r nrow(final_df)` rows and `r ncol(final_df)` columns. The range of years is (`r range(final_df$year)`). The names of key variables are: `r names(final_df)`.


### Problem 2


### Problem 3


